<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Language switcher template
 *
 * @see Mage_Page_Block_Switch
 */
?>

<?php
$cookie = Autel_Corto_Model_Core_Dispatch::RegistryCountry();
$enableStore = "";
foreach ($cookie->getEnabledStore() as $enStoreCode) {
    $enableStore .= $enStoreCode . ",";
}
if ($enableStore != "") {
    $enableStore = "," . $enableStore;
}
?>

<ul class="links store-language">
    <li>
        <a href="#" class="top-link-account" title="<?php echo $this->__('Select your Languages');?>">
            <?php echo $this->__("Language");?>
        </a>
    </li>    
</ul>

<div class="form-language" rel="top-link-account" style="display: none">    
    <div id="btn-remove"><a class="btn-remove"></a></div>
    <?php foreach (MAge::app()->getStores() as $_lang):          
echo "<!--$enableStore  " . $_lang->getCode() . " " . $_lang->getWebSiteId() .  "-->  " ;            
            if ($this->getCurrentWebsiteId() == $_lang->getWebSiteId() && $_lang->getIsActive()): 

                if ($enableStore == "" || strpos($enableStore, "," . $_lang->getCode() . ",") !== false):
                ?>    
    <div class="lang">
        <a href="<?php if ($_lang->getId() == $this->getCurrentStoreId()) : echo "#"; else: echo $_lang->getCurrentUrl(); endif; ?>" 
           class="<?php if ($_lang->getId() == $this->getCurrentStoreId()) : echo 'selected'; endif; ?>">
                <?php echo $this->htmlEscape($_lang->getName()) ?>
        </a>
    </div>
            <?php endif; ?>
        <?php endif; ?>
    <?php endforeach;?>
    
    <div class="lang">
        <a href="" onclick="$j.fn.selectCountry({'url': '<?php echo $this->getUrl("autelcorto/location/select"); ?>',
                                                 'countryCode': '<?php echo $cookie->getdata('country_code')?>',
                                                 'home': '<?php if ($this->getRequest()->getPathInfo() == "/"): echo "1"; else :echo "0"; endif; ?>',
                                                 'urlref': '<?php echo Mage::helper('core')->urlEncode(Mage::helper('core/url')->getCurrentUrl());?>'});return false;">
            <?php echo $this->__('Change Shipping Country') ?>
        </a>
    </div>
</div>
